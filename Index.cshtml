@{
    ViewData["Title"] = "Canadian National Parks";
}
<p>The user selects the province or territory in Canada. They are provided with the corresponding National Parks, Notable Animals and Best time to see the animals.</p>
<h2>Select a Province or Territory</h2>

<select id="provinceSelect" onchange="filterParks()">
    <option value="">Select Province/Territory</option>
    <option value="Alberta">Alberta</option>
    <option value="British Columbia">British Columbia</option>
    <option value="Manitoba">Manitoba</option>
    <option value="New Brunswick">New Brunswick</option>
    <option value="Newfoundland and Labrador">Newfoundland and Labrador</option>
    <option value="Nova Scotia">Nova Scotia</option>
    <option value="Ontario">Ontario</option>
    <option value="Prince Edward Island">Prince Edward Island</option>
    <option value="Quebec">Quebec</option>
    <option value="Saskatchewan">Saskatchewan</option>
    <option value="Northwest Territories">Northwest Territories</option>
    <option value="Nunavut">Nunavut</option>
    <option value="Yukon">Yukon</option>
</select>

<div id="parksTable" style="margin-top:20px;">
    <!-- Table will be inserted here dynamically -->
</div>

<script>
    function filterParks() {
        const selected = document.getElementById("provinceSelect").value;
        if (!selected) {
            document.getElementById("parksTable").innerHTML = "";
            return;
        }

        fetch(`/Parks/ByProvince?province=${encodeURIComponent(selected)}`)
            .then(response => response.json())
            .then(data => {
                if (!data.length) {
                    document.getElementById("parksTable").innerHTML = "<p>No parks found for this province or territory.</p>";
                    return;
                }

                let html = "<table border='1' cellpadding='5' cellspacing='0'><thead><tr><th>Park Name</th><th>Notable Animals</th><th>Best Time to See</th></tr></thead><tbody>";
                data.forEach(park => {
                    park.notableAnimals.forEach(animal => {
                        html += `<tr>
                            <td>${park.name}</td>
                            <td>${animal.animalName}</td>
                            <td>${animal.bestTimeToSee}</td>
                        </tr>`;
                    });
                });
                html += "</tbody></table>";
                document.getElementById("parksTable").innerHTML = html;
            })
            .catch(error => {
                console.error("Error fetching parks data:", error);
                document.getElementById("parksTable").innerHTML = "<p>Something went wrong while fetching data.</p>";
            });
    }
</script>
